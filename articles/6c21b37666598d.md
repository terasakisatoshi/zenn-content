---
title: "JuliaFormatter.jl ã§ã‚³ãƒ¼ãƒ‰ã‚’æ•´ãˆã‚‹ãŠè©±"
emoji: "ğŸ–‹ï¸"
type: "tech"
topics:
  - "julia"
published: true
published_at: "2022-02-05 15:14"
---

# æœ¬æ—¥ã¯

[JuliaFormatter.jl](https://github.com/domluna/JuliaFormatter.jl) ã®ç´¹ä»‹ã§ã™.
è‡ªåˆ†ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå˜ä½ã ã£ãŸã‚Šç‰¹å®šã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ•´å½¢ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™. 

ä¸€èˆ¬ã«ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯æ›¸ãæ™‚é–“ã‚ˆã‚Šã‚‚èª­ã‚€/èª­ã¾ã‚Œã‚‹æ™‚é–“ã®æ–¹ãŒå¤šã„ã§ã™ï¼ä»–äºº(=Nãƒ¶æœˆå¾Œã®æœªæ¥ã®è‡ªåˆ†è‡ªèº«ã‚‚å«ã‚€)ãŒèª­ã‚€éš›ã«æ›¸ã„ã¦ã‚ã‚‹äº‹æŸ„ã‚’æ­£ç¢ºã«æŠŠæ¡ã—ã¦ã‚‚ã‚‰ã†ã“ã¨ã¯éå¸¸ã«é‡è¦ã§ã™. è¨˜è¿°ã«ä¸€è²«æ€§ãŒã‚ã‚‹ãƒ»ãªã—ã§ã¯é›²æ³¥ã®å·®ãŒã‚ã‚Šã¾ã™. ã‚ã‚‹ç¨®ã®ä¸€è²«æ€§ã‚’å˜ä¸€ã®ãƒ•ã‚¡ã‚¤ãƒ«ã ã‘ã§ãªãï¼Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå˜ä½ã§ä¿ã¤ã®ã¯æ‰‹å‹•ã§ã¯å¤§å¤‰ã§ã™ï¼ãã“ã§ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦è‡ªå‹•åŒ–ã—ã¦ã‚‚ã‚‰ã„ã¾ã—ã‚‡ã†. JuliaFormatter.jl ã¯ãã®ä¸€ã¤ã§ã™.

# ä½¿ã„æ–¹

ã¾ãšã¯ä¸‹è¨˜ã®ã‚ˆã†ã«ã—ã¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™. Julia ã® REPL ã‚’é–‹ã„ã¦ `-e` ã®å¾Œã‚ã®æ–‡å­—åˆ—ã‚’å®Ÿè¡Œã™ã‚‹ã§ã‚‚OKã§ã™.

```console
$ julia -e 'using Pkg; Pkg.add("JuliaFormatter")'
```

æ¬¡ã«æ•´å½¢ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹å ´æ‰€ã¾ã§ç§»å‹•ã—ã¾ã™ï¼ä¾‹ãˆã° Git ãªã©ã§ç®¡ç†ã—ã¦ã„ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ç›´ä¸‹ãªã©ã§ã™ï¼ãã®ã‚ã¨ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«ã™ã‚‹ã¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ `src`, `test` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹ã® `.jl` ãƒ•ã‚¡ã‚¤ãƒ«ãŸã¡ãŒæ•´å½¢ã•ã‚Œã¾ã™.

```console
$ julia
               _
   _       _ _(_)_     |  Documentation: https://docs.julialang.org
  (_)     | (_) (_)    |
   _ _   _| |_  __ _   |  Type "?" for help, "]?" for Pkg help.
  | | | | | | |/ _` |  |
  | | |_| | | | (_| |  |  Version 1.7.1 (2021-12-22)
 _/ |\__'_|_|_|\__'_|  |  Official https://julialang.org/ release
|__/                   |

julia> using JuliaFormatter
julia> format(".") # ç¾åœ¨ä½œæ¥­ã—ã¦ã„ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®šã—ã¦ã„ã‚‹.
```

- ç‰¹å®šã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã™ã‚‹å ´åˆã¯ `format_file("yourfile.jl")`
- ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’æ–‡å­—åˆ—ã¨ã—ã¦ã¨ã£ã¦ããŸã¨ãã«ã¯ `format_text("<ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰>")` 
ã®ã‚ˆã†ãªé–¢æ•°ãŒã‚ã‚Šã¾ã™.


# æ•´å½¢ãƒ«ãƒ¼ãƒ«ã®èª¿æ•´

å¥½ã¿ã®å•é¡Œã§ã¯ã‚ã‚Šã¾ã™ãŒ, ç§ã¯ Python ã§ã®é–‹ç™ºã¯ [black](https://github.com/psf/black) ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™. Julia ã§ã‚‚ãã‚Œã«è¿‘ã„ã‚‚ã®ãŒæ¬²ã—ã„ã¨æ€ã£ã¦ã„ã¾ã—ãŸï¼è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« `.JuliaFormatter.toml` (ãƒ•ã‚¡ã‚¤ãƒ«åãŒ `.` å§‹ã¾ã‚Šã«æ³¨æ„)ã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç›´ä¸‹ã«ãŠã„ã¦ãŠãã¨è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ«ãƒ¼ãƒ«ã«å¾“ã£ã¦æ•´å½¢ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™. ä¾‹ãˆã°ä¸‹è¨˜ã®ã‚ˆã†ã«ã—ã¾ã™.

```toml
remove_extra_newlines=true
join_lines_based_on_source=true
whitespace_in_kwargs=false
short_to_long_function_def=true
always_for_in=true
verbose=true
margin=92
```


2022/02/05 ã®æ™‚ç‚¹ã§ã¯ Julia 1.6 ã§ä¸Šè¨˜ã®è¨­å®šã¯ã†ã¾ãã„ãã¾ã›ã‚“ã§ã—ãŸãŒ 2023/12/15 ã®æ™‚ç‚¹ã§ã¯å‹•ä½œã—ã¾ã—ãŸ. ğŸ‰


```julia
julia> uisng PkgVersion
julia> PkgVersion.Version(JuliaFormatter)
v"1.0.43"
```

## é››å½¢ã‚’ä½¿ã†

ä¸Šã®è¨­å®šã¯ã‚ªãƒ¬ã‚ªãƒ¬è¨­å®šæ„ŸãŒã‚ã‚Šã¾ã™ã‚ˆã­ï¼ä»¥å‰ã¯ `margin = 88` ã‚’ã—ã¦ã¾ã—ãŸãŒ, ç‹­ã™ãã‚‹ã¨æ„Ÿã˜ã‚‹æ–¹ã‚‚ã„ã‚‰ã£ã—ã‚ƒã£ãŸã‚ˆã†ãªã®ã§ SciML ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚¬ã‚¤ãƒ‰ã§ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™:

```
Use 4 spaces per indentation level, no tabs.
Try to adhere to a 92 character line length limit.
```

See https://github.com/SciML/SciMLStyle?tab=readme-ov-file#specific-rules

æ–‡å­— SciML ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚¬ã‚¤ãƒ‰ã«æº–æ‹ ã—ãŸã„å ´åˆã¯ `.JuliaFormatter.toml` ã«ä¸‹è¨˜ã®å†…å®¹ã‚’æ›¸ã‘ã°OKã§ã™:

```toml:.JuliaFormatter.toml
style = "sciml"
```

ã‚‚ã¡ã‚ã‚“ä¸Šè¨˜ã«å¾®å°ãªå¤‰æ›´ã‚’åŠ ãˆã‚‹ã“ã¨ã‚‚ã§ãã¾ã™. `style = "sciml"` ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§å¾—ã‚‰ã‚Œã‚‹åŠ¹æœã¯

[SciML Style
](https://domluna.github.io/JuliaFormatter.jl/dev/sciml_style/) ã§ã‚‚ç¢ºèªã§ãã¾ã™ï¼

ä»–ã«ã‚‚ä¸‹è¨˜ã®ã‚ˆã†ãªã‚¹ã‚¿ã‚¤ãƒ«ã‚‚ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ï¼

- [YAS Style](https://domluna.github.io/JuliaFormatter.jl/dev/yas_style/)
- [Blue Style](https://domluna.github.io/JuliaFormatter.jl/dev/blue_style/) 


ã¡ã‚‡ã£ã¨è©¦ã—ã« Blue Style ã‚’è©¦ã—ã¦ã¿ãŸã„ãªãƒ¼ã£ã¦å ´åˆã¯ `format` é–¢æ•°ã«ã‚¹ã‚¿ã‚¤ãƒ«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ¸¡ã—å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼

```julia
julia> using JuliaFormatter; format(".", BlueStyle())
```

## ç‰¹å®šã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼Œãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ç„¡è¦–ã—ãŸã„å ´åˆ

ä¸‹è¨˜ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãã®ã¾ã¾ã§ã™ãŒ `ignore` ã«æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼

https://domluna.github.io/JuliaFormatter.jl/dev/config/#ignore

```toml:.JuliaFormatter.toml
ignore = ["file.jl", "directory", "file_*.jl"]
```

ã¾ãŸã‚³ãƒ¡ãƒ³ãƒˆã« `#! format: off` ãªã©ã‚’åŠ ãˆã¦ãŠãã“ã¨ã§ç‰¹å®šã®ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã«å¯¾ã™ã‚‹æ•´å½¢ä½œæ¥­ã‚’ç„¡è¦–ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼

https://domluna.github.io/JuliaFormatter.jl/dev/skipping_formatting/

# å¿œç”¨

## Pull Request ã®ãŠä¾›ã«ã‚‚(2022-05-22 ã®æ™‚ç‚¹)

GitHub Actions ã¨é€£æºã— PR ãŒããŸéš›ã«ãƒ•ã‚¡ã‚¤ãƒ«ãŸã¡ãŒã¡ã‚ƒã‚“ã¨æ•´å½¢ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™.

https://github.com/AtelierArith/Replay.jl/blob/main/.github/workflows/FormatCheck.yml

ã¾ãŸï¼ŒFlux3D.jl ã®å ´åˆã¯PRã¯åºƒãå—ã‘å…¥ã‚Œã¦ masterãƒ–ãƒ©ãƒ³ãƒã®å–ã‚Šè¾¼ã¿å¾Œã«æ©Ÿæ¢°çš„ã«æ•´å½¢ã—ã¦ãã‚Œã‚‹PRã‚’ç™ºè¡Œã™ã‚‹ä»•çµ„ã¿ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™.

https://github.com/FluxML/Flux3D.jl/blob/master/.github/workflows/format_pr.yml

## Pull Request ã®ãŠä¾›ã«ã‚‚(2023-12-15 ã®æ™‚ç‚¹)

å‰²ã¨ã‚¿ã‚¤ãƒ ãƒªãƒ¼ãªè©±ãªã®ã§ã™ãŒï¼ŒGitHub Actions ã§ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒæ•´å‚™ã•ã‚ŒãŸã‚ˆã†ã§ã™ï¼

> ä½•ã‚’æ•´ãˆãŸã®ã‹ï¼Ÿ
> å…¨éƒ¨ï¼

ã¨ã®ã“ã¨ï¼

ã“ã‚Œã‚‰ã¤ã„ã¦ã®è§£èª¬ã¯ä»Šæœˆã® Julia Tokai ã§ã®

https://juliatokai.connpass.com/event/304201/

Hyrodium ã•ã‚“ã®ç™ºè¡¨ã§ [julia-formatã‚’
æ•´ãˆãŸè©±ã¨è³ªå•](https://hackmd.io/@hyrodium/Hk1zPiMIp#/)

çŸ¥ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼

ä¸€èˆ¬äººã¯ä¸‹è¨˜ã®ã‚ˆã†ã«ä½¿ãˆã°OKï¼ˆã‚ã‚ŠãŒãŸã‚„ï¼‰:

```yml
# å‚è€ƒ: https://hackmd.io/@hyrodium/Hk1zPiMIp#/3
name: Format suggestions
on:
  pull_request:
jobs:
  code-style:
    runs-on: ubuntu-latest
    steps:
      - uses: julia-actions/julia-format@v2
```

GitHub Actions ã¯ã“ã¡ã‚‰ https://github.com/julia-actions/julia-format

## PkgTemplates.jl

PkgTemplates.jl (v"0.7.46") ã§ã¯ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œã‚‹ã¨ãã« `.JuliaFormatter.toml` ã‚’ç”Ÿæˆã—ã¦ãã‚Œã‚‹æ©Ÿèƒ½ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã—ãŸï¼

```julia
help?> Formatter
search: Formatter JuliaFormatter format_text

  Formatter(;
      file="~/.julia/packages/PkgTemplates/BFleG/templates/.JuliaFormatter.toml",
      style="nostyle"
  )

  Create a .JuliaFormatter.toml file, used by JuliaFormatter.jl
  (https://github.com/domluna/JuliaFormatter.jl) and the Julia VSCode extension to
  configure automatic code formatting.

  This file can be entirely customized by the user, see the JuliaFormatter.jl docs
  (https://domluna.github.io/JuliaFormatter.jl/stable/).

  Keyword Arguments
  ===================

    â€¢  file::String: Template file for .JuliaFormatter.toml.

    â€¢  style::String: Style name, defaults to "nostyle" for an empty style but
       can also be one of ("sciml", "blue", "yas") for a fully preconfigured
       style.
```


### ãŠã¾ã‘

ã¾ãƒ¼ï¼ã„ã¤ã‹èª°ã‹ã‚„ã‚‰ãªãã‚ƒãªãƒ¼ï¼è‡ªåˆ†ã‚„ã‚‹ã‹ãƒ¼æ‰‹ãŒå›ã£ã¦ãªã„ã£ã¦æ€ã£ã¦ãŸã¨ã“ã‚ã§ Hyrodium ã•ã‚“ãŒã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã•ã‚ŒãŸã‚ˆã†ãªã®ã§ GitHub ä¸Šã§ãƒ¯ãƒ³ã‚¿ã‚¤ãƒ ã‚¹ãƒãƒ³ã‚µãƒ¼ã‚’ç§ã®ãƒã‚±ãƒƒãƒˆãƒãƒãƒ¼ã§ã—ã¾ã—ãŸï¼

# ã¾ã¨ã‚

Julia ã§ã®ã‚³ãƒ¼ãƒ‰ã‚’æ•´å½¢ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã‚’ç´¹ä»‹ã—ã¾ã—ãŸ.
