---
title: "Python ã¨åŒæ§˜ã®ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã§ä½¿ãˆã‚‹ Plotly ã® Julia ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ä½œã‚Šã¾ã—ãŸ."
emoji: "ğŸ“Š"
type: "tech"
topics:
  - "javascript"
  - "julia"
  - "python"
  - "plotly"
published: true
published_at: "2022-02-04 23:50"
---

# æœ¬æ—¥ã¯

[PyPlotly.jl](https://github.com/AtelierArith/PyPlotly.jl)

ã‚’ä½œã‚Šã¾ã—ãŸã®è©±

# ä½œæˆã®èƒŒæ™¯
[Plotly](https://plotly.com/graphing-libraries/) ã¨ã„ã†å¯¾è©±çš„ãªæ“ä½œãŒå¾—æ„ãªã‚°ãƒ©ãƒ•æç”»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã‚ã‚Šã¾ã™. [Dash](https://dash.plotly.com/) ã¨ã„ã†Web ä¸Šã§ã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’ä½œã‚‹ã‚¢ãƒ—ãƒªã«ãŠã„ã¦ã‚°ãƒ©ãƒ•ã‚’æç”»ã™ã‚‹éš›ã«é‡å®ã•ã‚Œã¾ã™.

JS(=JavaScript) ã¯ã‚‚ã¡ã‚ã‚“ Python, R, Julia ã‚’ã¯ã˜ã‚ã¨ã™ã‚‹ã•ã¾ã–ã¾ãªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™.

![](https://storage.googleapis.com/zenn-user-upload/9eb8451bebe1-20220204.png)

Julia ã®å ´åˆã¯ [PlotlyJS.jl](https://github.com/JuliaPlots/PlotlyJS.jl) ã«ã‚ˆã£ã¦
æ©Ÿèƒ½ã‚’ä½¿ãˆã¾ã™. 

```julia
# https://plotly.com/julia/2d-histogram-contour/ ã‹ã‚‰æŠœç²‹
using PlotlyJS, Distributions

x = rand(Uniform(-1,1), 500)
y = rand(Uniform(-1,1), 500)

plot(histogram2dcontour(
        x = x,
        y = y,
        colorscale = "Jet",
        contours = attr(
            showlabels = true,
            labelfont = attr(
                family = "Raleway",
                color = "white"
            )
        ),
        hoverlabel = attr(
            bgcolor = "white",
            bordercolor = "black",
            font = attr(
                family = "Raleway",
                color = "black"
            )
        )

))
```

å†…éƒ¨ã§ã¯ JS ã® API ã«ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã‹ãªã‚Šä¼¼ãŸæ›¸ãæ–¹ãŒã§ãã¾ã™.

```js
// https://plotly.com/javascript/2d-histogram-contour/#styled-2d-histogram-contour ã‹ã‚‰æŠœç²‹
var x = [];
var y = [];
for (var i = 0; i < 500; i ++) {
	x[i] = Math.random();
	y[i] = Math.random() + 1;
}

var data = [
  {
    x: x,
    y: y,
    colorscale: 'Blues',
    type: 'histogram2dcontour',
    contours: {
      showlabels: true,
      labelfont: {
        family: 'Raleway',
        color: 'white'
      }
    },
    hoverlabel: {
      bgcolor: 'white',
      bordercolor: 'black',
      font: {
        family: 'Raleway',
        color: 'black'
      }
    }
  }
];
Plotly.newPlot('myDiv', data);
```

ä¸€æ–¹ã§ Python ã®å ´åˆã¯ã©ã†ã§ã—ã‚‡ã†?

```
# https://plotly.com/python/2d-histogram-contour/ ã‹ã‚‰æŠœç²‹
import plotly.graph_objects as go

import numpy as np

x = np.random.uniform(-1, 1, size=500)
y = np.random.uniform(-1, 1, size=500)

fig = go.Figure(go.Histogram2dContour(
        x = x,
        y = y,
        colorscale = 'Jet',
        contours = dict(
            showlabels = True,
            labelfont = dict(
                family = 'Raleway',
                color = 'white'
            )
        ),
        hoverlabel = dict(
            bgcolor = 'white',
            bordercolor = 'black',
            font = dict(
                family = 'Raleway',
                color = 'black'
            )
        )

))

fig.show()
```

å¤§ä½“ä¼¼ã¦ã‚‹ã¨ã„ãˆã°ä¼¼ã¦ã¾ã™ãŒ, `go = plotly.graph_objects` ã‚’ä½¿ã£ã¦ãŸã‚ŠäºŒæ¬¡å…ƒã®ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã®åå‰ãŒ Python ã®ã‚¯ãƒ©ã‚¹ã®ã‚³ãƒ¼ãƒ‰è¦ç´„ã«å‰‡ã—ãŸ upper camel case ã«ãªã£ã¦ã„ã¾ã™. ã¾ãŸ `plotly.express` ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã„ã†ç‹¬è‡ªã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚‚æŒã£ã¦ã„ã¾ã™.

ã“ã‚Œã¯é¶ vs. åµãªè©±ã«è¿‘ã, ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼ãŒæœ€åˆã«è¦šãˆãŸè¨€èªãŒ Python ã§ãã®APIãŒè‡ªç„¶è¦‹ãˆã‚‹ã¨ã™ã‚Œã°ã° JS å´ Julia å´ãŒç‹¬ç‰¹ã¨ãªã£ã¦ã—ã¾ã†ã‚ã‘ã§ã™. ãã—ã¦ plotly ã§æ¤œç´¢ã™ã‚‹ã¨å¤šãã®å ´åˆ Python ã‹ã‚‰ä½¿ã†æ–¹æ³•ãŒã‚ˆãå‡ºã¦ã—ã¾ã†.

è‡ªåˆ†ã‚‚ Python ã‚’ä¸»ã«ä½¿ã£ã¦ã„ãŸã®ã‚‚ã‚ã‚Š Pythonã§æ›¸ã‹ã‚ŒãŸã‚‚ã®ã‚’ JS ã®æ›¸ãæ–¹ã«æŒã£ã¦ã„ãã®ã¯ã¡ã‚‡ã£ã¨ã—ã‚“ã©ã„ã‚ã‘ã§ã™. ã“ã®ã‚¯ãƒ©ã‚¹ã¯ JS/Julia ã ã¨ã©ã†æ›¸ãã®ã‹ï¼Ÿ API ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã¨ç¨ã‚ã£ã“ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼ã‚°ãƒƒã‚°ã£ã¦ã‚‚ä¸€ç™ºã§ãƒ’ãƒƒãƒˆã—ãªã„ (^^;)

## ãã‚“ãªã‚ã‘ã§

ãã‚“ãªã‚ã‘ã§ï¼ŒPython ã‹ã‚‰ Julia ã«ç§»è¡Œã™ã‚‹å ´åˆã«ã‚‚ãã®è¾ºã®èª²é¡ŒãŒã‚ã£ãŸã®ã§ãã‚Œã‚’è§£æ¶ˆã™ã‚‹ãŸã‚ã«
[PyPlotly.jl](https://github.com/AtelierArith/PyPlotly.jl) ã‚’ä½œã‚Šã¾ã—ãŸ.

åå‰ã« `PyPlotly` ã¨ã—ã¦ã„ã‚‹ã®ã¯ Plotly.jl ãŒæ—¢ã«ã‚ã‚‹ã‹ã‚‰ã§ã™. ã“ã‚Œã¯

> Plotting functions provided by this package are identical to PlotlyJS. Please consult its documentation. In fact, the package depends on PlotlyJS.jl and reexports all the methods.

ã¨ã‚ã‚‹ã‚ˆã†ã« Plolty ã®ã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã®ãŸã‚ã®APIã«å‘ã‘ãŸã‚‚ã®ã§ã™.

# ä½¿ã„æ–¹

ä»Šã®ã¨ã“ã‚é‡è‰¯ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãªã®ã§ä¸‹è¨˜ã®ã‚ˆã†ã«æ‰‹å‹•ã§ add ã‹ã‚¯ãƒ­ãƒ¼ãƒ³ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™.

```console
$ pip3 install numpy pandas plotly
$ git clone https://github.com/AtelierArith/PyPlotly.jl.git
$ cd PyPlotly
$ julia --project=@. -e 'using Pkg; Pkg.isinstance()'
```

ã‚³ãƒ¼ãƒ‰ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«ãªã‚Šã¾ã™.

```julia
using PyPlotly # ã“ã‚Œã‚’ã™ã‚‹ã¨ `go`, `px` ãŒä½¿ãˆã‚‹ 
go.Figure(
    go.Histogram2dContour(
        x = x,
        y = y,
        colorscale = "Jet",
        contours = Dict(
            :showlabels => true,
            :labelfont => Dict(:family => "Raleway", :color => "white"),
        ),
        hoverlabel = Dict(a)
    ),
)
```

![](https://storage.googleapis.com/zenn-user-upload/fc68322c8d64-20220204.png)

ãƒ‘ãƒƒãƒˆè¦‹ãŸç›® Python ã®æ›¸ãæ–¹ã¨ä¼¼ã¦ã„ã‚‹ã“ã¨ã«æ°—ã¥ãã¨æ€ã„ã¾ã™. Dict ã®éƒ¨åˆ†ã‚’èª¿ç¯€ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ãŒ, ã»ã¼ã»ã¼æ©Ÿæ¢°çš„ã«å¤‰æ›ã§ãã‚‹ã§ã—ã‚‡ã†.

README ã«æ›¸ã„ã¦ã‚ã‚‹ä¾‹ã§ã‚ã‚Œã°ã»ã¨ã‚“ã©åŒã˜æ›¸ãæ–¹ãŒã§ãã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ã§ã—ã‚‡ã†.

```python
# ã“ã‚Œã¯ Python
import plotly.graph_objects as go

# Create random data with numpy
import numpy as np
np.random.seed(1)

N = 100
random_x = np.linspace(0, 1, N)
random_y0 = np.random.randn(N) + 5
random_y1 = np.random.randn(N)
random_y2 = np.random.randn(N) - 5

fig = go.Figure()

# Add traces
fig.add_trace(go.Scatter(x=random_x, y=random_y0,
                    mode='markers',
                    name='markers'))
fig.add_trace(go.Scatter(x=random_x, y=random_y1,
                    mode='lines+markers',
                    name='lines+markers'))
fig.add_trace(go.Scatter(x=random_x, y=random_y2,
                    mode='lines',
                    name='lines'))

fig.show()
```

```julia
# ã“ã£ã¡ã¯ Julia
using PyPlotly # this exports `go` and `px`

using Random
Random.seed!(1)

N = 100
random_x = range(0, 1, length=N)
random_y0 = randn(N) .+ 5
random_y1 = randn(N)
random_y2 = randn(N) .- 5

fig = go.Figure()

# Add traces
fig.add_trace(go.Scatter(x=random_x, y=random_y0,
                    mode="markers",
                    name="markers"))
fig.add_trace(go.Scatter(x=random_x, y=random_y1,
                    mode="lines+markers",
                    name="lines+markers"))
fig.add_trace(go.Scatter(x=random_x, y=random_y2,
                    mode="lines",
                    name="lines"))

fig
```

![](https://storage.googleapis.com/zenn-user-upload/c1bfa42d08c2-20220204.png)

`px(=plotly.express)` ã«ã‚ˆã‚‹ä¾‹ãªã‚‰ãŸã ã®ã‚³ãƒ”ãƒšã§ Python <-> Julia ã®å¤‰æ›ãŒå³æ™‚å¯¾å¿œã§ãã¾ã™.

```julia
# using PyPlotly <--- Julia
# import plotly.express as px <--- Python

df = px.data.iris()
fig = px.scatter(
    df,
    x="sepal_width",
    y="sepal_length",
    color="species",
    size="petal_length",
    hover_data=["petal_width"],
)
fig
```

![](https://storage.googleapis.com/zenn-user-upload/62de899ed9e0-20220204.png)

å‹•ä½œåŸç†ã¯å…ˆæ—¥èª¬æ˜ã—ãŸ [Qulacs ã‚’ä¾‹ã« Julia ã‹ã‚‰ Python ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å‘¼ã¹ã‚‹ã‚ˆã†ã«ã™ã‚‹è©±](https://zenn.dev/terasakisatoshi/articles/983a7401524251) ã¨åŒæ§˜ã§ã™.

ã“ã®è¨˜äº‹ãŒå‡ºã‚‹2æ—¥å‰ã«é–‹ç™ºã‚’é–‹å§‹ã—[JuliaLang Live Coding (Making PyPlotly.jl) with a silent cat](https://www.youtube.com/watch?v=Nb_w0MV4OLs&t=20s) ã§ã¯ PyPlotly.jl ã®ãƒ¡ã‚¤ã‚­ãƒ³ã‚°å‹•ç”»ã‚’æ’®ã£ã¦ã„ã¾ã—ãŸ.ã€€ã“ã®ã‚ã¨ãƒã‚°ãŒè¦‹ã¤ã‹ã£ãŸã‚Š, æ©Ÿèƒ½æ‹¡å¼µã‚’ã™ã‚‹ãŸã‚ã«è©¦è¡ŒéŒ¯èª¤ã§ã¡ã‚‡ã£ã¨å¤‰ã‚ã£ã¦ã„ã¾ã™ãŒï¼Œæ€æƒ³ã¯å‹•ç”»ã«å«ã‚“ã§ã„ã‚‹å®Ÿè£…ã¨åŒã˜ã§ã™ï¼

# PlotlyJS.jl ã¸ã®å¤‰æ›

ä¸‹è¨˜ã®ã‚ˆã†ãªå¤‰æ›é–¢æ•°ã‚’ä½œæˆã™ã‚Œã°OKã§ã™ã“ã‚Œã¯ PyPlotly.jl ã§ã‚‚ä½¿ã£ã¦ã„ã¾ã™.

```julia
function create_plotlyjs(fig::GraphObjects.Figure)
    jsonobj = JSON.parse(fig.to_json())
    traces = PlotlyJS.GenericTrace.(jsonobj["data"])
    layout = PlotlyJS.Layout(jsonobj["layout"])
    return PlotlyJS.plot(traces, layout)
end
```

ã“ã‚Œã«ã‚ˆã£ã¦ IJulia ä¸Šãªã©ã§æç”»ã™ã‚‹ã¨ãã«ã€€PlotlyJS.jl ã® `display` é–¢æ•°ã‚’åˆ©ç”¨ã—è‡ªåˆ†ã§ã¯å®Ÿè£…ã™ã‚‹å¿…è¦ãŒãªã„ã‚ˆã†ã«ã§ãã¾ã™.

# ã¾ã¨ã‚

Python ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å„ªã—ã„ Julia ã‹ã‚‰ Plotly ã‚’ä½¿ã†æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã—ãŸï¼